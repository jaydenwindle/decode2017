<% content_for :javascript do %>
  <% javascript_include_tag 'dash_main', :id => 'dash-main-script', :'data-embed' => !@giveaways.any? %>
<% end %>
<% content_for :javascript do %>
  <% if !@giveaways.any? %>
    <% javascript_include_tag 'dash_submit', :id => 'dash-script', :'data-embed' => !@giveaways.any? %>
  <% end %>
<% end %>

<div class="centerify">
  <div>
    <div class="container">
      <div class="row mt-2 mb-5">
        <div class="col-12 text-center">
          <h1>Welcome to the Giveaways!</h1>
          <p>Where you give stuff away for free. Because business.</p>
        </div>
      </div>

      <% if !@giveaways.any? %>

        <div class="row" ng-if="giveaways.length === 0">
          <div class="col-8 offset-2 text-center">
            <p class="lead">You've never given anything away before. Stop being a republican and let's create a giveaway.</p>
          </div>
        </div>

      <% else %>

      <div class="row">
        <div class="col-12">
          <div class="row">
            <div class="col-12">
              <% if @giveaways.length > 1 %>
                <h3>Current giveaway</h3>
              <% else %>
                <h3>Most active giveaway</h3>
              <% end %>
            </div>
          </div>

      <% @giveaways.select(&:isActive?).each do |g| %>
          <!-- main giveaway -->
          <div class="row">
            <div class="card card-inverse card-massive col-12" style="background-image: url(https://www.tesla.com/tesla_theme/assets/img/models/section-hero-background.jpg?20170115); ">
              <div class="w-100 overlay">
                <div class="col-12 text-left">
                  <div class="card-block">
                    <h4 class="card-title mb-0"><%= g.name %></h4>
                  </div>

                  <ul class="list-group list-group-flush">
                    <%#<li class="list-group-item"><span class="font-weight-bold"><span class="mr-1">⏰</span> left</span><span class="super-bold ml-auto">23 days</span></li>%>
                    <li class="list-group-item"><span class="font-weight-bold">Number of <span class="ml-1">😊</span></span><span class="super-bold ml-auto"><%= g.users.length %> ppl.</span></li>
                    <li class="list-group-item"><span class="font-weight-bold">Number of <span class="ml-1">💰</span></span><span class="super-bold ml-auto"><%= g.products.map(&:quantity).sum %> prizes</span></li>
                    <li class="list-group-item"><span class="font-weight-bold">Share Link</span><span class="super-bold ml-auto"><a href="<%= "#{request.protocol}#{request.host_with_port}/giveaways/#{g.id}/enter" %>" target="_blank"><%= "#{request.protocol}#{request.host_with_port}/giveaways/#{g.id}/enter" %></a></span></li>
                  </ul>

                  <div class="card-block text-right">
                     <%= link_to("End", end_giveaway_path(g.id), :class=>"btn btn-sm btn-danger")%>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <!-- "main" giveaway  -->

      <% end %>

      <!-- Past: start -->
      <div class="row">
        <div class="col-12">
          <div class="row">
            <div class="col-12">
              <h3>Past giveaways</h3>
            </div>
          </div>

          <div class="row">
            <div class="col-12">
              <!-- start columns -->
              <div class="card-columns">
              <% @giveaways.select{|give| !give.isActive}.each do |gp| %>
                <div class="card ended">
                  <div class="card-block">
                    <h4 class="card-title pl-0 mb-0"><%= gp.name %></h4>
                  </div>

                  <ul class="list-group list-group-flush">
                    <%#<li class="list-group-item"><span class="font-weight-bold"><span class="mr-1">⏰</span> ran</span><span class="super-bold ml-auto">23 days</span></li>%>
                    <li class="list-group-item"><span class="font-weight-bold">Number of <span class="ml-1">😊</span></span><span class="super-bold ml-auto"><%= g.p.users.length %> ppl.</span></li>
                    <li class="list-group-item"><span class="font-weight-bold">Number of <span class="ml-1">💰</span></span><span class="super-bold ml-auto"><%= g.p.products.map(&:quantity).sum %> prizes</span></li>
                  </ul>
                </div>
              <% end %>
            </div>
          </div>
        </div>
      </div>
      <!-- Past: end -->

    <% end %>

    <% if !@giveaways.any? %>
      <div class="col-md-8 push-md-2">
          <%= render("form") %>
      </div>
    <% end %>
    </div>

  </div>
</div>
